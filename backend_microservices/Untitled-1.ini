You are an expert backend architect and Python developer. Build a production-ready, scalable, secure, and modular quick-commerce (q-commerce) platform inspired by Blinkit, starting with a single dark store. The system must support ultra-fast grocery delivery (under 30 mins) with features like cart, checkout, order tracking, delivery partner flow, real-time location sharing, and push notifications â€” all built using 100% free, open-source, or freemium tools. 

Hard Constraint: Zero Budget. No paid services. All components must be self-hostable or on a generous free tier. 

ğŸ› ï¸ Tech Stack (Free & Open Source Only)
LAYER
TECHNOLOGY
REASON
Backend
FastAPI (Python 3.10+)
Fast, async, OpenAPI-ready
Database
PostgreSQL
Self-hosted, free, robust
ORM
SQLAlchemy 2.0 + asyncpg
Open-source, async support
Caching
Redis (self-hosted)
Free, fast
Message Queue
Celery + Redis
For async tasks
File Storage
Cloudflare R2 (Free Tier: 10GB, 1M downloads/month)
S3-compatible, no egress fees
Authentication
Firebase Authentication (Free Tier)
Phone/email OTP, 10K MAUs free
Push Notifications
Firebase Cloud Messaging (FCM) - Free
Unlimited push
Real-Time Location
Supabase Realtime (Free Tier)
Up to 50 concurrent users, WebSocket auto-handled
Search
Meilisearch (Self-Hosted, Open-Source)
Typo-tolerant, fast, free
Frontend (Reference)
React Native (Expo) / React
Open-source
Hosting
Render.com (Free Tier)
or
Fly.io
or
Railway.app
Free PostgreSQL + Redis
CI/CD
GitHub Actions (Free)
For automated deployment
Logging
Loguru + Papertrail (Free Tier)
Simple logging
Monitoring
Sentry (Free Tier)
Error tracking
SMS (OTP)
Textbelt (Free: 1/day)
or
D7 Network (Free Tier)
Low-volume OTP
Email
Resend (3K free/month)
or
Mailgun (10K free/month)
Transactional emails

ğŸ§± Core Features
User OTP Login (via Firebase Auth)
Product Catalog (CRUD, images, inventory)
Cart Management (add/remove/update)
Delivery Time Slot Selection
Order Placement & Lifecycle Tracking
Delivery Partner Module:
Login
Accept/Reject Orders
Update Status
Share Live GPS Location (via Supabase Realtime)
Push Notifications (via FCM)
Admin View (via direct DB or Supabase UI)
Reviews & Ratings
Coupons & Offers
Cancellation & Refund (manual)
ğŸ—ï¸ Project Structure (No /v1, All Routes in routes/)
blinkit_clone/
â”‚
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py                     # FastAPI app instance, middleware, routes mount
â”‚   â”‚
â”‚   â”œâ”€â”€ config/                     # Configs
â”‚   â”‚   â”œâ”€â”€ settings.py             # Environment variables (pydantic.BaseSettings)
â”‚   â”‚   â””â”€â”€ database.py             # Async engine, session
â”‚   â”‚
â”‚   â”œâ”€â”€ routes/                     # All API routes (no versioning)
â”‚   â”‚   â”œâ”€â”€ auth.py                 # /auth/login, /auth/verify-otp
â”‚   â”‚   â”œâ”€â”€ products.py             # /products, /products/{id}
â”‚   â”‚   â”œâ”€â”€ cart.py                 # /cart/add, /cart/remove
â”‚   â”‚   â”œâ”€â”€ orders.py               # /orders/create, /orders/user/{user_id}
â”‚   â”‚   â”œâ”€â”€ delivery.py             # /delivery/assign, /delivery/location
â”‚   â”‚   â”œâ”€â”€ notifications.py        # /notifications/send (internal)
â”‚   â”‚   â””â”€â”€ admin.py                # /admin/products, /admin/orders
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                     # SQLAlchemy models
â”‚   â”‚   â”œâ”€â”€ user.py
â”‚   â”‚   â”œâ”€â”€ product.py
â”‚   â”‚   â”œâ”€â”€ cart.py
â”‚   â”‚   â”œâ”€â”€ order.py
â”‚   â”‚   â”œâ”€â”€ delivery.py
â”‚   â”‚   â””â”€â”€ __init__.py
â”‚   â”‚
â”‚   â”œâ”€â”€ schemas/                    # Pydantic models
â”‚   â”‚   â”œâ”€â”€ user.py
â”‚   â”‚   â”œâ”€â”€ product.py
â”‚   â”‚   â”œâ”€â”€ cart.py
â”‚   â”‚   â”œâ”€â”€ order.py
â”‚   â”‚   â””â”€â”€ delivery.py
â”‚   â”‚
â”‚   â”œâ”€â”€ firebase/                   # Firebase Admin SDK
â”‚   â”‚   â”œâ”€â”€ config.py               # Firebase app init
â”‚   â”‚   â””â”€â”€ auth.py                 # Verify ID token
â”‚   â”‚
â”‚   â”œâ”€â”€ supabase/                   # Supabase client for Realtime
â”‚   â”‚   â””â”€â”€ client.py               # Supabase realtime location push
â”‚   â”‚
â”‚   â”œâ”€â”€ services/                   # Business logic
â”‚   â”‚   â”œâ”€â”€ auth_service.py
â”‚   â”‚   â”œâ”€â”€ cart_service.py
â”‚   â”‚   â”œâ”€â”€ order_service.py
â”‚   â”‚   â””â”€â”€ notification_service.py # FCM + email/SMS
â”‚   â”‚
â”‚   â”œâ”€â”€ celery_tasks/               # Async tasks
â”‚   â”‚   â”œâ”€â”€ tasks.py                # Celery app, FCM, email, sync location
â”‚   â”‚   â””â”€â”€ __init__.py
â”‚   â”‚
â”‚   â”œâ”€â”€ static/                     # Uploaded files (optional symlink to R2)
â”‚   â”‚
â”‚   â””â”€â”€ utils/                      # Helpers
â”‚       â”œâ”€â”€ location.py             # Distance calculation
â”‚       â””â”€â”€ logger.py               # Loguru setup
â”‚
â”œâ”€â”€ migrations/                     # Alembic migrations
â”‚
â”œâ”€â”€ docker-compose.yml              # PostgreSQL, Redis, Meilisearch, FastAPI
â”œâ”€â”€ Dockerfile                      # For FastAPI app
â”œâ”€â”€ celery_worker.py                # Celery worker script
â”œâ”€â”€ .env.example                    # Environment template
â”œâ”€â”€ requirements.txt                # All dependencies
â””â”€â”€ README.md                       # Setup, run, deploy guide
ğŸ” Security & Best Practices
Use Firebase ID tokens (from client) â†’ verify server-side
Rate limiting via Redis (100 req/min per IP)
CORS: Allow localhost, *.web.app, *.firebaseapp.com
Input validation with Pydantic
JWT not stored in DB â€” stateless auth
Secure headers via middleware
.env for secrets
ğŸ” Real-Time Location Sharing (No Raw WebSockets)
Use Supabase Realtime: 

Table: delivery_locations (id, delivery_id, lat, lng, timestamp)
Enable Realtime on this table in Supabase Dashboard
FastAPI writes location â†’ Supabase broadcasts to all subscribers
Mobile app (React Native) listens via @supabase/supabase-js
Free for up to 50 concurrent connections
ğŸ“¡ Push Notifications
Use Firebase Cloud Messaging (FCM): 

On order status change, trigger Celery task
Send push to user device (FCM token stored in DB)
Free forever for typical app usage
ğŸ³ Docker & Deployment
docker-compose.yml includes:
postgres:15
redis:7
getmeili/meilisearch:latest
FastAPI app
Deploy to:
Render.com: Free PostgreSQL, free web service (with Redis add-on)
Fly.io: Free Postgres, free VMs
Railway.app: Free tier with PostgreSQL + Redis
All support free SSL, custom domains, and GitHub integration. 

ğŸ“‚ API Routes (No /v1)
/auth/login                 POST    â†’ sends OTP (via Firebase)
/auth/verify-otp            POST    â†’ verifies OTP, returns JWT
/products                   GET     â†’ list all products
/products/{id}              GET     â†’ product detail
/cart/add                   POST    â†’ add item to cart
/cart/remove                POST    â†’ remove item
/orders/create              POST    â†’ create order from cart
/orders/user/{user_id}      GET     â†’ user's order history
/delivery/assign            POST    â†’ assign delivery exec to order
/delivery/location          POST    â†’ update GPS (sync to Supabase)
/delivery/status            PUT     â†’ update delivery status
/notifications/send         POST    â†’ internal (Celery task)
/admin/products             GET/POST â†’ admin product management
ğŸ“ Deliverables to Generate
Produce:

Complete project structure as above
main.py with app creation and route mounting
routes/ files with full API endpoints
models/ and schemas/ for core entities
firebase/auth.py to verify Firebase ID token
supabase/client.py to push location to Supabase
celery_tasks/tasks.py for FCM and async updates
docker-compose.yml with PostgreSQL, Redis, Meilisearch
.env.example with all required keys
README.md with setup, run, and deploy instructions
